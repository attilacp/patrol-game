console.log('ðŸ“ fileUpload/core.js carregando...');
function processWorkbook(e,t){if(!window.subjects)window.subjects={};e.SheetNames.forEach(n=>{const o=e.Sheets[n],r=XLSX.utils.sheet_to_json(o,{header:1});if(r.length>1){const e=r[0]&&r[0][0]?r[0][0].toString().trim():"",o=r[0]&&r[0][1]?r[0][1].toString().trim():"",a=r[0]&&r[0][2]?r[0][2].toString().trim():"",s=r[0]&&r[0][3]?r[0][3].toString().trim():"";let d="";o&&(d+=o),a&&(d&&(d+="; "),d+=a),s&&(d&&(d+="; "),d+=s),!d&&e&&(d=e);let i="";o&&(i+=o),a&&(i&&(i+="; "),i+=a),s&&(i&&(i+="; "),i+=s);const c=l(r,n,d);if(!window.subjects[n]){window.subjects[n]={name:n,displayName:n,cellA1:e,cellB1:o,cellC1:a,cellD1:s,assuntoJogo:d,assuntoLista:i,questions:[],enabled:!0,fileName:t,recurrence:"alta"};window.subjects[n].questions.push(...c)}else{console.log(`âš ï¸ Assunto ${n} jÃ¡ existe. Substituindo perguntas.`);window.subjects[n].questions=c;window.subjects[n].fileName=t;window.subjects[n].cellA1=e;window.subjects[n].cellB1=o;window.subjects[n].cellC1=a;window.subjects[n].cellD1=s;window.subjects[n].assuntoJogo=d;window.subjects[n].assuntoLista=i}}}),updateFileStatus("âœ… "+Object.keys(window.subjects).length+" assuntos carregados","success");const a=document.getElementById("file-error");a&&(a.style.display="none"),"function"==typeof updateSubjectsList&&updateSubjectsList(),"function"==typeof updateTotalQuestionsCount&&updateTotalQuestionsCount(),"function"==typeof checkStartGame&&checkStartGame()}function l(e,t,n){const o=e[1],r=[];let a=o.findIndex(e=>e&&e.toString().toLowerCase().includes("enunciado")),s=o.findIndex(e=>e&&e.toString().toLowerCase().includes("gabarito")),d=[];o.forEach((e,t)=>{if(e&&"string"==typeof e&&(e.toLowerCase().includes("comentÃ¡rio")||e.toLowerCase().includes("comentario")))d.push(t)});if(-1!==a&&-1!==s)for(let i=2;i<e.length;i++){const l=e[i];if(l&&l[a]){const e=[];d.forEach(t=>{l[t]&&l[t].toString().trim()&&e.push(l[t].toString().trim())});const o={enunciado:l[a],gabarito:l[s]?l[s].toString().toUpperCase().trim():"",comentario:e.length>0?e[0]:"",comentario2:e.length>1?e[1]:"",comentario3:e.length>2?e[2]:"",assunto:t,assuntoInfo:n};r.push(o)}}return console.log("ðŸ“Š "+r.length+" perguntas extraÃ­das de "+t+" com "+d.length+" colunas de comentÃ¡rio"),r}"undefined"!=typeof window&&(window.processWorkbook=processWorkbook,window.extractQuestionsFromSheet=l,console.log("âœ… fileUpload/core.js exportado"));